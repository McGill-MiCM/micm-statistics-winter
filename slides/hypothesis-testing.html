<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Hypothesis testing | Introduction to Statistics in R</title>
  <meta name="description" content="3 Hypothesis testing | Introduction to Statistics in R" />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Hypothesis testing | Introduction to Statistics in R" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Hypothesis testing | Introduction to Statistics in R" />
  
  
  

<meta name="author" content="Gerardo Martínez" />


<meta name="date" content="2023-03-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="basic-concepts-in-probability.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="some-words-about-the-workshop.html"><a href="some-words-about-the-workshop.html"><i class="fa fa-check"></i><b>1</b> Some words about the workshop</a></li>
<li class="chapter" data-level="2" data-path="basic-concepts-in-probability.html"><a href="basic-concepts-in-probability.html"><i class="fa fa-check"></i><b>2</b> Basic concepts in probability</a>
<ul>
<li class="chapter" data-level="2.1" data-path="basic-concepts-in-probability.html"><a href="basic-concepts-in-probability.html#basic-definition"><i class="fa fa-check"></i><b>2.1</b> Basic definition</a></li>
<li class="chapter" data-level="2.2" data-path="basic-concepts-in-probability.html"><a href="basic-concepts-in-probability.html#the-probability-mass-function-pmf"><i class="fa fa-check"></i><b>2.2</b> The probability mass function (pmf)</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="basic-concepts-in-probability.html"><a href="basic-concepts-in-probability.html#simulating-bernoulli-trials"><i class="fa fa-check"></i><b>2.2.1</b> Simulating Bernoulli trials</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="basic-concepts-in-probability.html"><a href="basic-concepts-in-probability.html#the-cumulative-distribution-function-cdf"><i class="fa fa-check"></i><b>2.3</b> The cumulative distribution function (cdf)</a></li>
<li class="chapter" data-level="2.4" data-path="basic-concepts-in-probability.html"><a href="basic-concepts-in-probability.html#examples-of-discrete-random-variables-the-binomial-distribution"><i class="fa fa-check"></i><b>2.4</b> Examples of discrete random variables: The binomial distribution</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="basic-concepts-in-probability.html"><a href="basic-concepts-in-probability.html#simulating-random-values-from-a-binomial-distribution"><i class="fa fa-check"></i><b>2.4.1</b> Simulating random values from a binomial distribution</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="basic-concepts-in-probability.html"><a href="basic-concepts-in-probability.html#examples-of-discrete-random-variables-the-poisson-distribution"><i class="fa fa-check"></i><b>2.5</b> Examples of discrete random variables: The Poisson distribution</a></li>
<li class="chapter" data-level="2.6" data-path="basic-concepts-in-probability.html"><a href="basic-concepts-in-probability.html#continuous-random-variables"><i class="fa fa-check"></i><b>2.6</b> Continuous random variables</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="basic-concepts-in-probability.html"><a href="basic-concepts-in-probability.html#histogram-as-a-density-estimator"><i class="fa fa-check"></i><b>2.6.1</b> Histogram as a density estimator</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="basic-concepts-in-probability.html"><a href="basic-concepts-in-probability.html#normal-distribution"><i class="fa fa-check"></i><b>2.7</b> Normal distribution</a></li>
<li class="chapter" data-level="2.8" data-path="basic-concepts-in-probability.html"><a href="basic-concepts-in-probability.html#mean-and-variance"><i class="fa fa-check"></i><b>2.8</b> Mean and variance</a></li>
<li class="chapter" data-level="2.9" data-path="basic-concepts-in-probability.html"><a href="basic-concepts-in-probability.html#the-law-of-large-numbers"><i class="fa fa-check"></i><b>2.9</b> The Law of Large Numbers</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>3</b> Hypothesis testing</a>
<ul>
<li class="chapter" data-level="3.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#introductory-example"><i class="fa fa-check"></i><b>3.1</b> Introductory example</a></li>
<li class="chapter" data-level="3.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#hypothesis-testing-1"><i class="fa fa-check"></i><b>3.2</b> Hypothesis testing</a></li>
<li class="chapter" data-level="3.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#testing-for-the-mean-of-a-population-simulating-the-probability"><i class="fa fa-check"></i><b>3.3</b> Testing for the mean of a population: Simulating the probability</a></li>
<li class="chapter" data-level="3.4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#testing-for-the-mean-of-a-population-obtaining-an-analytical-expression-for-the-probability"><i class="fa fa-check"></i><b>3.4</b> Testing for the mean of a population: Obtaining an analytical expression for the probability</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Statistics in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="hypothesis-testing" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Hypothesis testing<a href="hypothesis-testing.html#hypothesis-testing" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introductory-example" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Introductory example<a href="hypothesis-testing.html#introductory-example" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We have been hired to do quality control at a factory that produces dice for a board game in which getting a <span class="math inline">\(6\)</span> is extremely important. We know don’t want to ruin the players’ experience so if a die is not a fair die we want to discard the die. Given a particular die we construct two hypothesis:</p>
<p><span class="math display">\[\begin{equation*}
H_0: \text{The die is fair} \quad \text{and} \quad H_1: \text{The die is not fair}
\end{equation*}\]</span></p>
<p>Given time constraints we have only time to throw the die a hundred times. If the die is fair we expect to see approximately <span class="math inline">\(100 \times \frac{1}{6} \approx 17\)</span> sixes, so we create the following rule: <em>if the number of 6 is higher than 20, we will discard the die</em>.</p>
<p>The company is very environmentally friendly so we don’t want to throw unnecessary dice. We would take an incorrect decision if the die is fair but we decide to throw it. Given a perfectly good die, we want to estimate how frequently we would throw incorrectly these dice.</p>
<p>Let us first simulate 100 tosses of 1000 dice. One way of doing this is simulating <span class="math inline">\(100 \times 1000\)</span> tosses and then puting the result in a matrix.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="hypothesis-testing.html#cb19-1" aria-hidden="true" tabindex="-1"></a>fair_dice_tosses <span class="ot">&lt;-</span> <span class="fu">rdunif</span>(<span class="dv">100</span><span class="sc">*</span><span class="dv">1000</span>)</span>
<span id="cb19-2"><a href="hypothesis-testing.html#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="hypothesis-testing.html#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Turn the previous vector into a matrix</span></span>
<span id="cb19-4"><a href="hypothesis-testing.html#cb19-4" aria-hidden="true" tabindex="-1"></a>fair_dice_tosses <span class="ot">&lt;-</span> <span class="fu">matrix</span>(fair_dice_tosses, <span class="at">nrow =</span> <span class="dv">100</span>)</span></code></pre></div>
<p>To check this is indeed a fair die we can check it by plotting a histogram of the dataset.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="hypothesis-testing.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fair_dice_tosses,</span>
<span id="cb20-2"><a href="hypothesis-testing.html#cb20-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb20-3"><a href="hypothesis-testing.html#cb20-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Outcome of a fair die toss&quot;</span>)</span></code></pre></div>
<p>Here comes the tricky part. We want for each of die we want to calculate the number of sixes that were observed.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="hypothesis-testing.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a vector that will store the result</span></span>
<span id="cb21-2"><a href="hypothesis-testing.html#cb21-2" aria-hidden="true" tabindex="-1"></a>fair_die_number_sixes <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">1000</span>)</span>
<span id="cb21-3"><a href="hypothesis-testing.html#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="hypothesis-testing.html#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Record the number of sixes</span></span>
<span id="cb21-5"><a href="hypothesis-testing.html#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb21-6"><a href="hypothesis-testing.html#cb21-6" aria-hidden="true" tabindex="-1"></a>  fair_die_number_sixes[j] <span class="ot">&lt;-</span> <span class="fu">sum</span>(fair_dice_tosses[,j] <span class="sc">==</span> <span class="dv">6</span>)</span>
<span id="cb21-7"><a href="hypothesis-testing.html#cb21-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Let us see how this looks by plotting a histogram.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="hypothesis-testing.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fair_die_number_sixes,</span>
<span id="cb22-2"><a href="hypothesis-testing.html#cb22-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&#39;Number of sixes in 100 fair die tosses&#39;</span>,</span>
<span id="cb22-3"><a href="hypothesis-testing.html#cb22-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&#39;Number of sixes&#39;</span>,</span>
<span id="cb22-4"><a href="hypothesis-testing.html#cb22-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;deepskyblue&quot;</span>)</span></code></pre></div>
<p><img src="Introduction-to-Statistics_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>We are now ready to estimate the probability of throwing away a perfectly good die.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="hypothesis-testing.html#cb23-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">sum</span>(fair_die_number_sixes<span class="sc">&gt;</span><span class="dv">20</span>))<span class="sc">/</span><span class="dv">1000</span></span></code></pre></div>
<pre><code>## [1] 0.15</code></pre>
<p>Maybe our problem is we are being too strict with our rule of decision. Let us change it and let us say that we will throw the die if the number of sixes is higher than 25. Let us recalculate now the probability of throwing good die.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="hypothesis-testing.html#cb25-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">sum</span>(fair_die_number_sixes<span class="sc">&gt;</span><span class="dv">25</span>))<span class="sc">/</span><span class="dv">1000</span></span></code></pre></div>
<pre><code>## [1] 0.01</code></pre>
<p>Now sometimes the machine produces dice that are loaded and have a lower probability of landing on a <span class="math inline">\(1\)</span> or <span class="math inline">\(6\)</span> but higher probability of landing on a <span class="math inline">\(5\)</span> or a <span class="math inline">\(2\)</span>. We would like our rule to also make us throw those dice away. Let us estimate now what is the probability of not throwing away those dice.</p>
<p>First let us build a function in R to throw loaded dice.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="hypothesis-testing.html#cb27-1" aria-hidden="true" tabindex="-1"></a>loaded_die_random <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb27-2"><a href="hypothesis-testing.html#cb27-2" aria-hidden="true" tabindex="-1"></a>  probs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">18</span>, <span class="dv">4</span><span class="sc">/</span><span class="dv">18</span>, <span class="dv">3</span><span class="sc">/</span><span class="dv">18</span>, <span class="dv">3</span><span class="sc">/</span><span class="dv">18</span>, <span class="dv">4</span><span class="sc">/</span><span class="dv">18</span>, <span class="dv">2</span><span class="sc">/</span><span class="dv">18</span>)</span>
<span id="cb27-3"><a href="hypothesis-testing.html#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> probs))</span>
<span id="cb27-4"><a href="hypothesis-testing.html#cb27-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Let us repeat what we did for the fair die but now for the loaded one.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="hypothesis-testing.html#cb28-1" aria-hidden="true" tabindex="-1"></a>loaded_dice_tosses <span class="ot">&lt;-</span> <span class="fu">loaded_die_random</span>(<span class="dv">100</span><span class="sc">*</span><span class="dv">1000</span>)</span>
<span id="cb28-2"><a href="hypothesis-testing.html#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="hypothesis-testing.html#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Turn the previous vector into a matrix</span></span>
<span id="cb28-4"><a href="hypothesis-testing.html#cb28-4" aria-hidden="true" tabindex="-1"></a>loaded_dice_tosses <span class="ot">&lt;-</span> <span class="fu">matrix</span>(loaded_dice_tosses, <span class="at">nrow =</span> <span class="dv">100</span>)</span>
<span id="cb28-5"><a href="hypothesis-testing.html#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="hypothesis-testing.html#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(loaded_dice_tosses,</span>
<span id="cb28-7"><a href="hypothesis-testing.html#cb28-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb28-8"><a href="hypothesis-testing.html#cb28-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Outcome of a loaded die toss&quot;</span>)</span></code></pre></div>
<p>Let us check now how the distribution of sixes look.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="hypothesis-testing.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a vector that will store the result</span></span>
<span id="cb29-2"><a href="hypothesis-testing.html#cb29-2" aria-hidden="true" tabindex="-1"></a>loaded_die_number_sixes <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">1000</span>)</span>
<span id="cb29-3"><a href="hypothesis-testing.html#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="hypothesis-testing.html#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Record the number of sixes</span></span>
<span id="cb29-5"><a href="hypothesis-testing.html#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb29-6"><a href="hypothesis-testing.html#cb29-6" aria-hidden="true" tabindex="-1"></a>  loaded_die_number_sixes[j] <span class="ot">&lt;-</span> <span class="fu">sum</span>(loaded_dice_tosses[,j] <span class="sc">==</span> <span class="dv">6</span>)</span>
<span id="cb29-7"><a href="hypothesis-testing.html#cb29-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-8"><a href="hypothesis-testing.html#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="hypothesis-testing.html#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(loaded_die_number_sixes,</span>
<span id="cb29-10"><a href="hypothesis-testing.html#cb29-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&#39;Number of sixes in 100 loaded die tosses&#39;</span>,</span>
<span id="cb29-11"><a href="hypothesis-testing.html#cb29-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&#39;Number of sixes&#39;</span>,</span>
<span id="cb29-12"><a href="hypothesis-testing.html#cb29-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkgoldenrod2&quot;</span>)</span></code></pre></div>
<p>To check how different the distributions are we can overlap the histograms with the following code<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="hypothesis-testing.html#cb30-1" aria-hidden="true" tabindex="-1"></a>c1 <span class="ot">&lt;-</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">191</span>, <span class="dv">255</span>, <span class="dv">80</span>, <span class="at">max =</span> <span class="dv">255</span>)</span>
<span id="cb30-2"><a href="hypothesis-testing.html#cb30-2" aria-hidden="true" tabindex="-1"></a>c2 <span class="ot">&lt;-</span> <span class="fu">rgb</span>(<span class="dv">238</span>, <span class="dv">173</span>, <span class="dv">14</span>, <span class="dv">80</span>, <span class="at">max =</span> <span class="dv">255</span>)</span>
<span id="cb30-3"><a href="hypothesis-testing.html#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="hypothesis-testing.html#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co">#c1 &lt;- rgb(173,216,230,max = 255, alpha = 80, names = &quot;lt.blue&quot;)</span></span>
<span id="cb30-5"><a href="hypothesis-testing.html#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co">#c2 &lt;- rgb(255,192,203, max = 255, alpha = 80, names = &quot;lt.pink&quot;)</span></span>
<span id="cb30-6"><a href="hypothesis-testing.html#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="hypothesis-testing.html#cb30-7" aria-hidden="true" tabindex="-1"></a>min_hist <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">c</span>(fair_die_number_sixes,loaded_die_number_sixes)) <span class="sc">-</span> <span class="fl">0.001</span> <span class="co"># Set the minimum for the breakpoints</span></span>
<span id="cb30-8"><a href="hypothesis-testing.html#cb30-8" aria-hidden="true" tabindex="-1"></a>max_hist <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">c</span>(fair_die_number_sixes,loaded_die_number_sixes)) <span class="co"># Set the maximum for the breakpoints</span></span>
<span id="cb30-9"><a href="hypothesis-testing.html#cb30-9" aria-hidden="true" tabindex="-1"></a>ax <span class="ot">&lt;-</span> <span class="fu">pretty</span>(min_hist<span class="sc">:</span>max_hist, <span class="at">n =</span> <span class="dv">12</span>) <span class="co"># Make a neat vector for the breakpoints</span></span>
<span id="cb30-10"><a href="hypothesis-testing.html#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="hypothesis-testing.html#cb30-11" aria-hidden="true" tabindex="-1"></a>hgA <span class="ot">&lt;-</span> <span class="fu">hist</span>(fair_die_number_sixes, </span>
<span id="cb30-12"><a href="hypothesis-testing.html#cb30-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">breaks =</span> ax, </span>
<span id="cb30-13"><a href="hypothesis-testing.html#cb30-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">plot =</span> <span class="cn">FALSE</span>) <span class="co"># Save first histogram data</span></span>
<span id="cb30-14"><a href="hypothesis-testing.html#cb30-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-15"><a href="hypothesis-testing.html#cb30-15" aria-hidden="true" tabindex="-1"></a>hgB <span class="ot">&lt;-</span> <span class="fu">hist</span>(loaded_die_number_sixes, <span class="at">breaks =</span> ax, <span class="at">plot =</span> <span class="cn">FALSE</span>) <span class="co"># Save 2nd histogram data</span></span>
<span id="cb30-16"><a href="hypothesis-testing.html#cb30-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-17"><a href="hypothesis-testing.html#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hgA, <span class="at">col =</span> c1, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Number of sixes&quot;</span>) <span class="co"># Plot 1st histogram using a transparent color</span></span>
<span id="cb30-18"><a href="hypothesis-testing.html#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hgB, <span class="at">col =</span> c2, <span class="at">add =</span> <span class="cn">TRUE</span>) <span class="co"># Add 2nd histogram using different color</span></span>
<span id="cb30-19"><a href="hypothesis-testing.html#cb30-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-20"><a href="hypothesis-testing.html#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb30-21"><a href="hypothesis-testing.html#cb30-21" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">25</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>We can now calculate the probability of not throwing the loaded die away.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="hypothesis-testing.html#cb31-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">sum</span>(fair_die_number_sixes<span class="sc">&lt;=</span><span class="dv">25</span>))<span class="sc">/</span><span class="dv">1000</span></span></code></pre></div>
</div>
<div id="hypothesis-testing-1" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Hypothesis testing<a href="hypothesis-testing.html#hypothesis-testing-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Given a random sample <span class="math inline">\(X_1, \dots, X_n\)</span> a hypothesis is a statement about one aspect of the underlying distribution of the data.</p>
<p>We will test two hypothesis, one is the null hypothesis and we denote it with <span class="math inline">\(H_0\)</span> and the other is the <em>alternate hypothesis</em> and we denote it with <span class="math inline">\(H_1\)</span>. In our previous example we had defined</p>
<p><span class="math display">\[\begin{equation*}
H_0: \text{The die is fair} \quad \text{and} \quad H_1: \text{The die is not fair}
\end{equation*}\]</span></p>
<p>A <strong>hypothesis test procedure</strong> or <strong>hypothesis test</strong> is a rule that specifies for which sample values <span class="math inline">\(H_0\)</span> is rejected for which sample values <span class="math inline">\(H_0\)</span> is not rejected. The set of samples for which we will reject the null hypothesis is called the <strong>rejection or critical region</strong>.</p>
<p>In our example we had checked two rules</p>
<ol style="list-style-type: decimal">
<li><p>We will reject the <span class="math inline">\(H_0\)</span> if the number of sixes is higher than <span class="math inline">\(20\)</span>.</p></li>
<li><p>We will reject the <span class="math inline">\(H_0\)</span> if the number of sixes is higher than <span class="math inline">\(25\)</span>.</p></li>
</ol>
<p>We can see that our decisions all depended on a function of our sample: in the example we had used the number of sixes. This will always be the case, the critical region will be dependent on a function of the sample that we will call the <strong>test statistic</strong>. Hence, in our example, the test statistic was ‘number of sixes in a hundred tosses of a die’.</p>
<p>As we have seen in the example of the dice, there are two sources of error while doing hypothesis testing:</p>
<ol style="list-style-type: decimal">
<li><p>The first type of error occurs when we reject the null hypothesis but the null hypothesis was actually true: this is called the <strong>type 1 error</strong>. In the example, we commited a type 1 error when we discarded fair dice.</p></li>
<li><p>The second type of error occurs when we fail to reject the null hypothesis but the null hypothesis was actually false: this is called the <strong>type 2 error</strong>. In the example, we committed a type 2 error when we did not discard loaded dice.</p></li>
</ol>
<p>We can summarize the distinct combinations of rejection/not rejection of the null hypothesis vs the actual truth in the following table:</p>
<table>
<thead>
<tr class="header">
<th align="right"></th>
<th align="center">Reject <span class="math inline">\(H_0\)</span></th>
<th align="center">Not reject <span class="math inline">\(H_0\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right"><span class="math inline">\(H_0\)</span> <strong>is true</strong></td>
<td align="center">Type 1 error</td>
<td align="center">Correct decision</td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(H_1\)</span> <strong>is true</strong></td>
<td align="center">Correct decision</td>
<td align="center">Type 2 error</td>
</tr>
</tbody>
</table>
<p>We saw that if we control to minimize the type 1 error, the type 2 error ended up being extremely high. Unfortunately, when doing hypothesis testing we won’t be able to minimize both errors at the same time. For this reason, we will fix a type 1 error and find the rejection region that minimizes the type 2 error. We will denote with <span class="math inline">\(\alpha\)</span> the type 1 error and with <span class="math inline">\(\beta\)</span> the type 2 error. The number <span class="math inline">\(\alpha\)</span> is called the <em>significance level</em> and the number <span class="math inline">\(1-\beta\)</span> (equal to the probability of obtaining a <em>true positive</em>) is called the <em>power of the test</em>.</p>
</div>
<div id="testing-for-the-mean-of-a-population-simulating-the-probability" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Testing for the mean of a population: Simulating the probability<a href="hypothesis-testing.html#testing-for-the-mean-of-a-population-simulating-the-probability" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the dataset <span class="math inline">\(\texttt{data_poisson.csv}\)</span> we have the number of times <span class="math inline">\(1000\)</span> nucleotides were read during sequencing. Let us first load the data and store it in a vector called <span class="math inline">\(\texttt{data_poisson}\)</span>.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="hypothesis-testing.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let us load the data</span></span>
<span id="cb32-2"><a href="hypothesis-testing.html#cb32-2" aria-hidden="true" tabindex="-1"></a>...</span></code></pre></div>
<p>We believe that despite paying for 50x coverage, we are not getting that coverage. We will admit the data follows a Poisson distribution of rate <span class="math inline">\(\lambda\)</span>. We propose the hypotheses
<span class="math display">\[\begin{equation*}
H_0: \lambda = 50 \quad \text{and} \quad H_1: \lambda \neq 50,
\end{equation*}\]</span></p>
<p>Let us fix a significance level of <span class="math inline">\(\lambda = 0.05\)</span>. We know that due to the Law of Large Numbers <span class="math inline">\(\bar{X}_n\)</span> is a <em>good</em> estimator of the expectation <span class="math inline">\(\mathbb{E}(X)\)</span>. So are going to construct the following rejection rule:
<span class="math display">\[\begin{equation*}
\text{If } |\bar{X}_{1000} - 50| &gt; k \text{ for some k, then we will reject the null hypothesis}
\end{equation*}\]</span>
We want to find the real value <span class="math inline">\(k\)</span> for which
<span class="math display">\[\begin{equation*}
\mathrm{P}(|\bar{X}_{1000} - 50| &gt; k | H_0 \text{ is true}) \leq 0.05.
\end{equation*}\]</span>
There is no built-in function to estimate this probability. For this reason we will estimate it through simulations.</p>
<p>First, we will simulate <span class="math inline">\(n = 10,000\)</span> samples of size <span class="math inline">\(1000\)</span> coming from a Poisson distribution. We want to estimate a probability <em>given that <span class="math inline">\(H_0\)</span> is true</em>. For this reason we will simulate the Poisson random values with rate <span class="math inline">\(\lambda = 50\)</span>.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="hypothesis-testing.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let us simulate 10,000 samples of size 1000 from a Poisson of rate 50</span></span>
<span id="cb33-2"><a href="hypothesis-testing.html#cb33-2" aria-hidden="true" tabindex="-1"></a>poisson_samples <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">10000</span><span class="sc">*</span><span class="dv">1000</span>, <span class="at">lambda =</span> <span class="dv">50</span>)</span>
<span id="cb33-3"><a href="hypothesis-testing.html#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="hypothesis-testing.html#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Let us turn this into a matrix having the samples as columns</span></span>
<span id="cb33-5"><a href="hypothesis-testing.html#cb33-5" aria-hidden="true" tabindex="-1"></a>poisson_samples <span class="ot">&lt;-</span> <span class="fu">matrix</span>(poisson_samples, <span class="at">nrow =</span> <span class="dv">1000</span>)</span></code></pre></div>
<p>For each of the datasets we must apply the test statistic which is <span class="math inline">\(|\bar{X}_{1000} - 50|\)</span>.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="hypothesis-testing.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We create an empty vector</span></span>
<span id="cb34-2"><a href="hypothesis-testing.html#cb34-2" aria-hidden="true" tabindex="-1"></a>test_poisson <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">10000</span>)</span>
<span id="cb34-3"><a href="hypothesis-testing.html#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="hypothesis-testing.html#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>){</span>
<span id="cb34-5"><a href="hypothesis-testing.html#cb34-5" aria-hidden="true" tabindex="-1"></a>  test_poisson[j] <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">mean</span>(poisson_samples[,j])<span class="sc">-</span><span class="dv">50</span>)</span>
<span id="cb34-6"><a href="hypothesis-testing.html#cb34-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Let us plot a histogram of the vector <span class="math inline">\(\texttt{test_poisson}\)</span>.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="hypothesis-testing.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a histogram of test_poisson</span></span>
<span id="cb35-2"><a href="hypothesis-testing.html#cb35-2" aria-hidden="true" tabindex="-1"></a>...</span></code></pre></div>
<p>We have now to find <span class="math inline">\(k\)</span> such that <span class="math inline">\(\mathrm{P}(|\bar{X}_{1000} - 50| &gt; k) \leq 0.05\)</span>. This equivalent to say we want <span class="math inline">\(k\)</span> such that<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a>
<span class="math display">\[\begin{equation*}
  \mathrm{P}(|\bar{X}_{1000} - 50| \leq k) \geq 1 - 0.05 = 0.95
\end{equation*}\]</span>
So we want the the value <span class="math inline">\(k\)</span> such that the cdf evaluated at <span class="math inline">\(k\)</span> is as large as <span class="math inline">\(0.95\)</span>. We say in this case that <span class="math inline">\(k\)</span> is the 95th quantile. Fortunately for us, in R we can use the function <span class="math inline">\(\texttt{quantile}\)</span>. The function <span class="math inline">\(\texttt{quantile}\)</span> will take two parameter</p>
<ul>
<li>A vector <span class="math inline">\(x\)</span> which we want to find a quantile.</li>
<li>A parameter <span class="math inline">\(\texttt{probs}\)</span> equal to the probability that we want to acumulate.</li>
</ul>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="hypothesis-testing.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(x, .<span class="dv">95</span>)</span></code></pre></div>
<p>Now we are ready to look at our original data and see if we would reject or not the null hypothesis. Let us find what is the test statistic in our case.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="hypothesis-testing.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">abs</span>(<span class="fu">mean</span>(data_poisson)<span class="sc">-</span><span class="dv">50</span>)</span></code></pre></div>
</div>
<div id="testing-for-the-mean-of-a-population-obtaining-an-analytical-expression-for-the-probability" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Testing for the mean of a population: Obtaining an analytical expression for the probability<a href="hypothesis-testing.html#testing-for-the-mean-of-a-population-obtaining-an-analytical-expression-for-the-probability" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the dataset <span class="math inline">\(\texttt{data_normal.csv}\)</span> we have 1000 values coming from a normal distribution. We know the data comes from a normal distribution with variance equal to <span class="math inline">\(1\)</span> but we are not fully sure if the expectation is equal to <span class="math inline">\(0\)</span>. We propose the hypotheses
<span class="math display">\[\begin{equation*}
H_0: \mu = 0 \quad \text{and} \quad H_1: \mu \neq 0.
\end{equation*}\]</span>
With Poisson random values it was definitely cumbersome to find the distribution of test statistic we had used. Luckily for us, with normal random values everything is <em>a lot</em> simpler.</p>
<p>If <span class="math inline">\(X_1, \dots X_n\)</span> are normally distributed with mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span> then the distribution of
<span class="math display">\[\begin{equation*}
T = \frac{\bar{X}_n - \mu}{\frac{1}{\sqrt{n}} S_n}, \quad \text{where} \quad S_n = \sqrt{S^2_n}
\end{equation*}\]</span>
follows a well-known distribution called a Student’s <span class="math inline">\(t\)</span>-distribution. The parameter of a <span class="math inline">\(t\)</span>-distribution is called its <em>degrees of freedom</em> and it is a natural number <span class="math inline">\(n\)</span>. The test statistic <span class="math inline">\(T\)</span> previously defined follows a <span class="math inline">\(t\)</span>-distribution with <span class="math inline">\(n-1\)</span> degrees of freedom with <span class="math inline">\(n\)</span> being the sample size. In R we have the usual functions for the pdf, cdf and random value generation and those are <span class="math inline">\(\texttt{dt}\)</span>, <span class="math inline">\(\texttt{pt}\)</span>, and <span class="math inline">\(\texttt{rt}\)</span>, respectively.</p>
<p>In this case, we will construct the following rejection region:
<span class="math display">\[\begin{equation*}
\text{If } |T| &gt; k \text{ for some k, then we will reject the null hypothesis.}
\end{equation*}\]</span>
We want to find the real value <span class="math inline">\(k\)</span> for which
<span class="math display">\[\begin{equation*}
\mathrm{P}(|T| &gt; k | H_0 \text{ is true}) \leq 0.05.
\end{equation*}\]</span>
It can be proven that this is equivalent to finding <span class="math inline">\(k&#39;\)</span> such that
<span class="math display">\[\begin{equation*}
\mathrm{P}(T \leq k&#39; | H_0 \text{ is true}) \leq \frac{0.05}{2} = 0.0025.
\end{equation*}\]</span></p>
<p>In R we can find such value using the function <span class="math inline">\(\texttt{qt}\)</span>. The function will take two parameters</p>
<ul>
<li><p>The probability <span class="math inline">\(p\)</span> for which we want to find <span class="math inline">\(x\)</span> such that <span class="math inline">\(\mathrm{P}(X \leq x) = p\)</span>.</p></li>
<li><p>The degrees of freedom <span class="math inline">\(n\)</span>.</p></li>
</ul>
<p>We can calculate then the real number <span class="math inline">\(k&#39;\)</span>. In this case the degrees of freedom are <span class="math inline">\(1000-1 = 999\)</span></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="hypothesis-testing.html#cb38-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qt</span>(<span class="fl">0.025</span>, <span class="dv">999</span>)</span></code></pre></div>
<p>We can now go back to our data and check if we will reject the null hypothesis. Fortunately for us, there is a function called <span class="math inline">\(\texttt{t.test}\)</span> that does everything for us.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="hypothesis-testing.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">x =</span> data_normal)</span></code></pre></div>
</div>
</div>











<div class="footnotes">
<hr />
<ol start="5">
<li id="fn5"><p>The code I present here is a modified version of the code found <a href="https://www.dataanalytics.org.uk/plot-two-overlapping-histograms-on-one-chart-in-r/">here</a>. The linked website has an in-depth explanation on histograms using base-R.<a href="hypothesis-testing.html#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p>This follows from the probability of the complement. Remember that if <span class="math inline">\(\mathrm{P}(A^c) = 1-\mathrm{P}(A)\)</span>.<a href="hypothesis-testing.html#fnref6" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="basic-concepts-in-probability.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
